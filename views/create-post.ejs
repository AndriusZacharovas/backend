<!DOCTYPE html>
<html lang="en">
    <%- include('includes/head') %>
<body>
    <%- include('includes/header') %>

    <main>
        <h2>Comments</h2>

        <% if (user) { %>
            <h3>Welcome, <%= user.username %>! Leave a comment:</h3>
            <form action="/create-post" method="POST">
                <% errors.forEach(error => { %>
                    <p class="notice"><%= error %></p>
                <% }) %>

                <label for="title">Title:</label>
                <input type="text" name="title" id="title" placeholder="Enter a title" required />

                <br>

                <label for="body">Comment:</label>
                <textarea name="body" id="body" rows="4" placeholder="Write your comment here..." required></textarea>

                <br>
                <button type="submit">Post Comment</button>
            </form>
        <% } else { %>
            <p><a href="/login">Log in</a> to post a comment.</p>
        <% } %>

        <hr>

        <h3>All Comments:</h3>
        <% if (comments.length > 0) { %>
            <ul>
                <% comments.forEach(comment => { %>
                </br>
                    <strong><%= comment.username %>:</strong> 
                    <%= comment.title %>
                    <%= comment.text %> 
                    <small>(<%= comment.createdAt %>)</small>
                <% }) %>
            </ul>
        <% } else { %>
            <p>No comments yet. Be the first to comment!</p>
        <% } %>

    </main>

    <%- include('includes/footer') %>
</body>
</html>